(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5696],{7825:(e,t,a)=>{Promise.resolve().then(a.bind(a,7480))},7480:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var s=a(926),r=a(5822),n=a(1695),i=a(6893),l=a(3525),o=a(9407),c=a(5057),d=a(1091),u=a(2862);let m=(0,a(350).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);function h(){let e=(0,n.useRouter)(),{toast:t}=(0,c.dj)(),{user:a}=(0,d.J)(),[h,x]=(0,r.useState)(""),[g,p]=(0,r.useState)(null),[f,b]=(0,r.useState)(""),[v,j]=(0,r.useState)(""),[y,N]=(0,r.useState)(""),[S,w]=(0,r.useState)({}),[_,T]=(0,r.useState)(!1),[k,A]=(0,r.useState)(null);(0,r.useEffect)(()=>{a&&(a.name&&b(a.name),a.email&&j(a.email),a.phone&&N(a.phone))},[a]),(0,r.useEffect)(()=>{try{let e=new URLSearchParams(window.location.search);x(e.get("eventId")||"")}catch(e){}},[]),(0,r.useEffect)(()=>{if(!h)return;let e=!0;return(async()=>{try{var t;let a=await fetch("/api/events?page=1&pageSize=50"),s=await a.json();if(!e)return;let r=null==s?void 0:null===(t=s.events)||void 0===t?void 0:t.find(e=>e.id===h);p(r||null)}catch(e){console.error(e)}})(),()=>{e=!1}},[h]);let E=async e=>{try{await navigator.clipboard.writeText(e),t({title:"Reference copied",description:e})}catch(e){console.error(e),t({title:"Copy failed"})}};return h?(0,s.jsxs)("div",{className:"relative min-h-screen overflow-hidden",children:[(0,s.jsx)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-0 bg-[linear-gradient(180deg,rgba(229,236,249,0.94)_0%,rgba(236,233,224,0.92)_18%,rgba(218,206,190,0.88)_38%,rgba(185,151,118,0.82)_56%,rgba(116,142,186,0.88)_76%,rgba(68,98,139,0.92)_90%,rgba(45,68,99,0.95)_100%)]"}),(0,s.jsxs)("div",{className:"relative z-10",children:[(0,s.jsx)(i.MainNav,{}),(0,s.jsx)("div",{className:"max-w-2xl mx-auto px-4 py-12",children:(0,s.jsxs)(o.Zp,{className:"p-8 bg-gradient-to-br from-[#f5ebe0] via-white to-[#f0e5d8] border border-[var(--border)] shadow-xl",children:[(0,s.jsxs)("h2",{className:"text-3xl font-bold mb-6 text-blue-900",children:["Sign up: ",(null==g?void 0:g.title)||"Loading..."]}),k?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[(0,s.jsx)(u.A,{className:"w-10 h-10 text-green-600"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Thanks ",k.name," — you're signed up!"]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["We've recorded your interest for ",(0,s.jsx)("strong",{children:null==g?void 0:g.title})," on ",function(e){if(!(null==e?void 0:e.startsAt))return"TBA";let t=new Date(e.startsAt),a=t.toLocaleDateString(),s=t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return"".concat(a," • ").concat(s)}(g),(null==g?void 0:g.location)?" at ".concat(g.location):"","."]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"text-sm text-gray-700",children:"Reference:"}),(0,s.jsx)("div",{className:"font-mono bg-gray-100 dark:bg-slate-800 px-3 py-1 rounded",children:(k.ref||"").slice(0,8)}),(0,s.jsx)("button",{onClick:()=>E((k.ref||"").slice(0,8)),className:"p-2 rounded bg-gray-100 dark:bg-slate-800 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors",children:(0,s.jsx)(m,{className:"w-4 h-4"})})]}),(()=>{let e=function(e){if(!e)return null;try{let t=JSON.stringify({id:e.id,ref:e.ref,eventId:e.eventId,name:e.name});return"https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=".concat(encodeURIComponent(t))}catch(e){return null}}(k);return e?(0,s.jsxs)("div",{className:"mt-4 flex flex-col items-center gap-3",children:[(0,s.jsx)("img",{src:e,alt:"Your ticket QR code",className:"w-48 h-48 bg-white p-2 rounded shadow"}),(0,s.jsx)("a",{href:e,download:"ticket_".concat((k.ref||"").slice(0,8),".png"),className:"text-sm text-blue-600 hover:underline",children:"Download ticket (PNG)"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Show this QR code at the event entrance. It encodes your signup reference."})]}):null})(),(0,s.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,s.jsx)(l.$,{onClick:()=>e.push("/events"),className:"bg-blue-600 hover:bg-blue-700",children:"Back to Events"}),(0,s.jsx)(l.$,{variant:"outline",onClick:()=>e.push("/dashboard"),children:"Go to Dashboard"})]})]}):(0,s.jsx)("form",{onSubmit:async e=>{e.preventDefault();let t={};if(f||(t.name="Name required"),v||(t.email="Email required"),Object.keys(t).length){w(t);return}T(!0);try{let e=await fetch("/api/events/signups",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:h,name:f,email:v,phone:y})});if(e.ok){let t=await e.json();A(t.signup)}else{let t=await e.json().catch(()=>({}));w((null==t?void 0:t.errors)||{form:(null==t?void 0:t.error)||"Failed"})}}catch(e){w({form:"Failed to submit"})}finally{T(!1)}},children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),(0,s.jsx)("input",{className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:f,onChange:e=>b(e.target.value)}),S.name&&(0,s.jsx)("p",{className:"text-sm text-red-600 mt-1",children:S.name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,s.jsx)("input",{type:"email",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:v,onChange:e=>j(e.target.value)}),S.email&&(0,s.jsx)("p",{className:"text-sm text-red-600 mt-1",children:S.email})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone (optional)"}),(0,s.jsx)("input",{type:"tel",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:y,onChange:e=>N(e.target.value)})]}),S.form&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:S.form}),(0,s.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,s.jsx)(l.$,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 flex-1",disabled:_,children:_?"Submitting...":"Submit Registration"}),(0,s.jsx)(l.$,{type:"button",variant:"outline",onClick:()=>e.push("/events"),children:"Cancel"})]})]})})]})})]})]}):(0,s.jsxs)("div",{className:"relative min-h-screen overflow-hidden",children:[(0,s.jsx)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-0 bg-[linear-gradient(180deg,rgba(229,236,249,0.94)_0%,rgba(236,233,224,0.92)_18%,rgba(218,206,190,0.88)_38%,rgba(185,151,118,0.82)_56%,rgba(116,142,186,0.88)_76%,rgba(68,98,139,0.92)_90%,rgba(45,68,99,0.95)_100%)]"}),(0,s.jsxs)("div",{className:"relative z-10",children:[(0,s.jsx)(i.MainNav,{}),(0,s.jsx)("div",{className:"max-w-2xl mx-auto px-4 py-12",children:(0,s.jsxs)(o.Zp,{className:"p-8 text-center",children:[(0,s.jsx)("p",{className:"text-lg text-gray-600",children:"Missing event ID"}),(0,s.jsx)(l.$,{onClick:()=>e.push("/events"),className:"mt-4 bg-blue-600",children:"Back to Events"})]})})]})]})}},9407:(e,t,a)=>{"use strict";a.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>l,Zp:()=>n,aR:()=>i});var s=a(926);a(5822);var r=a(2178);function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function i(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",t),...a})}function o(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...a})}function c(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",t),...a})}},5057:(e,t,a)=>{"use strict";a.d(t,{dj:()=>m});var s=a(5822);let r=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?i(a):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],c={toasts:[]};function d(e){c=l(c,e),o.forEach(e=>{e(c)})}function u(e){let{...t}=e,a=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>d({type:"DISMISS_TOAST",toastId:a});return d({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=s.useState(c);return s.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},2862:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(350).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1695:(e,t,a)=>{"use strict";var s=a(5159);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})}},e=>{var t=t=>e(e.s=t);e.O(0,[1085,666,13,9274,8304,6683,7358],()=>t(7825)),_N_E=e.O()}]);