(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7937],{2164:(e,t,r)=>{Promise.resolve().then(r.bind(r,1476))},1476:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var a=r(926),s=r(5822),n=r(9344),i=r(9407),d=r(3525),c=r(8491),l=r(5995),o=r(4968),x=r(8981),h=r(2862);function u(){var e,t,r,u,g,m,v,p,b,f,k;let[y,j]=(0,s.useState)(!1),[N,w]=(0,s.useState)(null),[C,I]=(0,s.useState)(""),[S,A]=(0,s.useState)(!1),[_,E]=(0,s.useState)(!1),R=(0,s.useRef)(null);(0,s.useRef)(null);let T=async()=>{try{I(""),w(null);let e=new n.j9("qr-reader");R.current=e,await e.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250}},F,P),j(!0)}catch(e){console.error("Error starting scanner:",e),I("Failed to start camera. Please check permissions.")}},z=async()=>{if(R.current)try{await R.current.stop(),R.current.clear(),R.current=null}catch(e){console.error("Error stopping scanner:",e)}j(!1)},F=async e=>{if(!S){A(!0),await z();try{let t=await fetch("/api/events/verify-ticket",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({qrData:e})}),r=await t.json();t.ok&&r.valid?(w(r),I("")):I(r.error||"Invalid ticket")}catch(e){I("Failed to verify ticket"),console.error("Verification error:",e)}finally{A(!1)}}},P=e=>{},$=async()=>{var e;if(null==N?void 0:null===(e=N.signup)||void 0===e?void 0:e.id){E(!0);try{let e=await fetch("/api/events/verify-ticket",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({signupId:N.signup.id})});if(e.ok)w({...N,alreadyCheckedIn:!0,signup:{...N.signup,checkedIn:!0,checkedInAt:new Date().toISOString()}});else{let t=await e.json();I(t.error||"Failed to check in")}}catch(e){I("Failed to check in attendee"),console.error("Check-in error:",e)}finally{E(!1)}}},O=()=>{w(null),I("")};return(0,s.useEffect)(()=>()=>{R.current&&z()},[]),(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-900 p-8",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-8 text-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Event Check-In"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Scan QR code tickets to verify and check in attendees"})]}),!y&&!N&&(0,a.jsx)(i.Zp,{className:"p-8",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"w-24 h-24 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center mx-auto",children:(0,a.jsx)(c.A,{className:"w-12 h-12 text-blue-600 dark:text-blue-400"})})}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Ready to Scan"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Click the button below to activate the camera and scan attendee QR codes"}),(0,a.jsxs)(d.$,{onClick:T,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3",children:[(0,a.jsx)(l.A,{className:"w-5 h-5 mr-2"}),"Start Scanner"]})]})}),y&&(0,a.jsxs)(i.Zp,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Scanning..."}),(0,a.jsxs)(d.$,{onClick:z,variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-50",children:[(0,a.jsx)(o.A,{className:"w-4 h-4 mr-2"}),"Stop"]})]}),(0,a.jsx)("div",{id:"qr-reader",className:"rounded-lg overflow-hidden"}),(0,a.jsx)("p",{className:"text-center text-sm text-gray-600 dark:text-gray-400 mt-4",children:"Position the QR code within the frame"})]}),C&&!N&&(0,a.jsx)(i.Zp,{className:"p-6 border-red-200 dark:border-red-800",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)(x.A,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-900 dark:text-red-100 mb-2",children:"Verification Failed"}),(0,a.jsx)("p",{className:"text-red-700 dark:text-red-300 mb-4",children:C}),(0,a.jsx)(d.$,{onClick:O,className:"bg-red-600 hover:bg-red-700 text-white",children:"Try Again"})]})]})}),N&&N.valid&&(0,a.jsxs)(i.Zp,{className:"p-6 ".concat(N.alreadyCheckedIn||(null===(e=N.signup)||void 0===e?void 0:e.checkedIn)?"border-green-200 dark:border-green-800":"border-blue-200 dark:border-blue-800"),children:[(0,a.jsxs)("div",{className:"flex items-start gap-4 mb-6",children:[(0,a.jsx)(h.A,{className:"w-8 h-8 flex-shrink-0 ".concat(N.alreadyCheckedIn||(null===(t=N.signup)||void 0===t?void 0:t.checkedIn)?"text-green-600":"text-blue-600")}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-1",children:N.alreadyCheckedIn||(null===(r=N.signup)||void 0===r?void 0:r.checkedIn)?"✅ Already Checked In":"✓ Valid Ticket"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:null===(u=N.event)||void 0===u?void 0:u.title})]})]}),(0,a.jsxs)("div",{className:"space-y-4 bg-gray-50 dark:bg-slate-800 p-4 rounded-lg mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Attendee Name"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:null===(g=N.signup)||void 0===g?void 0:g.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Email"}),(0,a.jsx)("p",{className:"text-gray-900 dark:text-white",children:null===(m=N.signup)||void 0===m?void 0:m.email})]}),(null===(v=N.signup)||void 0===v?void 0:v.phone)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Phone"}),(0,a.jsx)("p",{className:"text-gray-900 dark:text-white",children:N.signup.phone})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ticket Reference"}),(0,a.jsx)("p",{className:"font-mono text-gray-900 dark:text-white",children:null===(p=N.signup)||void 0===p?void 0:p.ref})]}),(N.alreadyCheckedIn||(null===(b=N.signup)||void 0===b?void 0:b.checkedIn))&&(null===(f=N.signup)||void 0===f?void 0:f.checkedInAt)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Checked In At"}),(0,a.jsx)("p",{className:"text-gray-900 dark:text-white",children:new Date(N.signup.checkedInAt).toLocaleString()})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[!N.alreadyCheckedIn&&!(null===(k=N.signup)||void 0===k?void 0:k.checkedIn)&&(0,a.jsx)(d.$,{onClick:$,disabled:_,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:_?"Checking In...":(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{className:"w-4 h-4 mr-2"}),"Check In"]})}),(0,a.jsx)(d.$,{onClick:()=>{O(),T()},variant:"outline",className:"flex-1",children:"Scan Next"})]})]})]})})}},3525:(e,t,r)=>{"use strict";r.d(t,{$:()=>c});var a=r(926);r(5822);var s=r(7897),n=r(8341),i=r(2178);let d=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function c(e){let{className:t,variant:r,size:n,asChild:c=!1,...l}=e,o=c?s.DX:"button";return(0,a.jsx)(o,{"data-slot":"button",className:(0,i.cn)(d({variant:r,size:n,className:t})),...l})}},9407:(e,t,r)=>{"use strict";r.d(t,{BT:()=>c,Wu:()=>l,ZB:()=>d,Zp:()=>n,aR:()=>i});var a=r(926);r(5822);var s=r(2178);function n(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function i(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...r})}function d(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",t),...r})}function c(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",t),...r})}function l(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",t),...r})}},2178:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var a=r(589),s=r(9704);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[9459,1085,9038,8304,6683,7358],()=>t(2164)),_N_E=e.O()}]);