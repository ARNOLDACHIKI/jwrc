(()=>{var e={};e.id=9610,e.ids=[9610],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79428:e=>{"use strict";e.exports=require("buffer")},55511:e=>{"use strict";e.exports=require("crypto")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},49949:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>N,routeModule:()=>h,serverHooks:()=>v,workAsyncStorage:()=>R,workUnitAsyncStorage:()=>y});var s={};r.r(s),r.d(s,{DELETE:()=>j,GET:()=>m,POST:()=>f,dynamic:()=>l});var n=r(62137),o=r(63654),a=r(48093),u=r(63e3),i=r(96330),c=r(77136),p=r.n(c);let d=new i.PrismaClient,l="force-dynamic";function x(e){let t=(e.headers.get("cookie")||"").split(";").map(e=>e.trim()).find(e=>e.startsWith("token="));return t?t.split("=")[1]:null}async function m(){try{let e=await d.announcement.findMany({orderBy:{postedAt:"desc"}});return u.NextResponse.json({announcements:e})}catch(e){return u.NextResponse.json({error:"Failed to fetch announcements"},{status:500})}}async function f(e){try{let t=x(e),r=process.env.JWT_SECRET||"dev-secret";if(!t)return u.NextResponse.json({error:"Unauthorized"},{status:401});let s=null;try{s=p().verify(t,r)}catch(e){return u.NextResponse.json({error:"Unauthorized"},{status:401})}if("admin"!==s.role)return u.NextResponse.json({error:"Forbidden"},{status:403});let{title:n,content:o}=await e.json();if(!n||!o)return u.NextResponse.json({error:"Missing fields"},{status:400});let a=await d.announcement.create({data:{title:n,content:o,author:s.email}});return u.NextResponse.json({announcement:a},{status:201})}catch(e){return u.NextResponse.json({error:"Server error"},{status:500})}}async function j(e){try{let t=x(e),r=process.env.JWT_SECRET||"dev-secret";if(!t)return u.NextResponse.json({error:"Unauthorized"},{status:401});let s=null;try{s=p().verify(t,r)}catch(e){return u.NextResponse.json({error:"Unauthorized"},{status:401})}if("admin"!==s.role)return u.NextResponse.json({error:"Forbidden"},{status:403});let{id:n}=await e.json()||{};if(!n)return u.NextResponse.json({error:"Missing id"},{status:400});try{let e=await d.announcement.delete({where:{id:n}});return u.NextResponse.json({deleted:e})}catch(e){if("P2025"===e.code)return u.NextResponse.json({error:"Not found"},{status:404});return u.NextResponse.json({error:"Failed to delete"},{status:500})}}catch(e){return u.NextResponse.json({error:"Server error"},{status:500})}}let h=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/announcements/route",pathname:"/api/announcements",filename:"route",bundlePath:"app/api/announcements/route"},resolvedPagePath:"/home/lod/Downloads/jwrc/app/api/announcements/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:R,workUnitAsyncStorage:y,serverHooks:v}=h;function N(){return(0,a.patchFetch)({workAsyncStorage:R,workUnitAsyncStorage:y})}},62290:()=>{},51674:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[5089,9862,7136],()=>r(49949));module.exports=s})();