{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/lod/Downloads/jwrc/app/api/mpesa/token/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\n\nconst SANDBOX_BASE = 'https://sandbox.safaricom.co.ke'\nconst LIVE_BASE = 'https://api.safaricom.co.ke'\n\nexport async function GET() {\n  try {\n    const consumerKey = process.env.MPESA_CONSUMER_KEY\n    const consumerSecret = process.env.MPESA_CONSUMER_SECRET\n    if (!consumerKey || !consumerSecret) return NextResponse.json({ error: 'MPESA credentials missing' }, { status: 500 })\n    const env = process.env.MPESA_ENV || 'sandbox'\n    const baseUrl = env === 'production' ? LIVE_BASE : SANDBOX_BASE\n    const basic = Buffer.from(`${consumerKey}:${consumerSecret}`).toString('base64')\n    const res = await fetch(`${baseUrl}/oauth/v1/generate?grant_type=client_credentials`, {\n      headers: { Authorization: `Basic ${basic}` },\n    })\n    if (!res.ok) return NextResponse.json({ error: 'Token request failed', status: res.status }, { status: 502 })\n    const data = await res.json()\n    return NextResponse.json(data)\n  } catch (e: any) {\n    console.error('MPESA token error', e?.message || e)\n    return NextResponse.json({ error: e?.message || 'Server error' }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,eAAe;AACrB,MAAM,YAAY;AAEX,eAAe;IACpB,IAAI;QACF,MAAM,cAAc,QAAQ,GAAG,CAAC,kBAAkB;QAClD,MAAM,iBAAiB,QAAQ,GAAG,CAAC,qBAAqB;QACxD,IAAI,CAAC,eAAe,CAAC,gBAAgB,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA4B,GAAG;YAAE,QAAQ;QAAI;QACpH,MAAM,MAAM,QAAQ,GAAG,CAAC,SAAS,IAAI;QACrC,MAAM,UAAU,QAAQ,eAAe,YAAY;QACnD,MAAM,QAAQ,OAAO,IAAI,CAAC,GAAG,YAAY,CAAC,EAAE,gBAAgB,EAAE,QAAQ,CAAC;QACvE,MAAM,MAAM,MAAM,MAAM,GAAG,QAAQ,gDAAgD,CAAC,EAAE;YACpF,SAAS;gBAAE,eAAe,CAAC,MAAM,EAAE,OAAO;YAAC;QAC7C;QACA,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;YAAwB,QAAQ,IAAI,MAAM;QAAC,GAAG;YAAE,QAAQ;QAAI;QAC3G,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,OAAO,+QAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,GAAQ;QACf,QAAQ,KAAK,CAAC,qBAAqB,GAAG,WAAW;QACjD,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO,GAAG,WAAW;QAAe,GAAG;YAAE,QAAQ;QAAI;IAClF;AACF","debugId":null}}]
}