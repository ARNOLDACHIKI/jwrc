{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///home/lod/Downloads/jwrc/lib/db.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst globalForPrisma = global as unknown as { __prisma?: PrismaClient }\n\nconst prisma = globalForPrisma.__prisma ?? new PrismaClient()\nif (process.env.NODE_ENV !== 'production') globalForPrisma.__prisma = prisma\n\nexport async function safeExecute(sql: string, ...params: any[]) {\n  try {\n    return await prisma.$executeRawUnsafe(sql, ...params)\n  } catch (err: any) {\n    console.warn('DB execute failed:', err?.message || err)\n    return null\n  }\n}\n\nexport async function safeQuery<T = any>(sql: string, ...params: any[]): Promise<T[]> {\n  try {\n    const rows = await prisma.$queryRawUnsafe(sql, ...params)\n    return Array.isArray(rows) ? (rows as T[]) : (rows ? [rows as T] : [])\n  } catch (err: any) {\n    console.warn('DB query failed:', err?.message || err)\n    return []\n  }\n}\n\nexport { prisma }\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEA,MAAM;AAEN,MAAM,SAAS,gBAAgB,QAAQ,IAAI,IAAI,6IAAY;AAC3D,wCAA2C,gBAAgB,QAAQ,GAAG;AAE/D,eAAe,YAAY,GAAW,EAAE,GAAG,MAAa;IAC7D,IAAI;QACF,OAAO,MAAM,OAAO,iBAAiB,CAAC,QAAQ;IAChD,EAAE,OAAO,KAAU;QACjB,QAAQ,IAAI,CAAC,sBAAsB,KAAK,WAAW;QACnD,OAAO;IACT;AACF;AAEO,eAAe,UAAmB,GAAW,EAAE,GAAG,MAAa;IACpE,IAAI;QACF,MAAM,OAAO,MAAM,OAAO,eAAe,CAAC,QAAQ;QAClD,OAAO,MAAM,OAAO,CAAC,QAAS,OAAgB,OAAO;YAAC;SAAU,GAAG,EAAE;IACvE,EAAE,OAAO,KAAU;QACjB,QAAQ,IAAI,CAAC,oBAAoB,KAAK,WAAW;QACjD,OAAO,EAAE;IACX;AACF","debugId":null}},
    {"offset": {"line": 89, "column": 0}, "map": {"version":3,"sources":["file:///home/lod/Downloads/jwrc/app/api/mpesa/status/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport { prisma, safeQuery } from '@/lib/db'\n\nexport async function GET(req: Request) {\n  try {\n    const url = new URL(req.url)\n    const localIdRaw = url.searchParams.get('localId')\n    if (!localIdRaw) return NextResponse.json({ error: 'localId required' }, { status: 400 })\n    const localId = parseInt(localIdRaw, 10)\n    if (Number.isNaN(localId)) return NextResponse.json({ error: 'localId must be an integer' }, { status: 400 })\n\n    const rows: any = await safeQuery(`SELECT id, amount, phone, account_reference, merchant_request_id, checkout_request_id, status, mpesa_transaction_id, provider_response FROM mpesa_donations WHERE id=$1::int LIMIT 1`, localId)\n    const rec = rows?.[0] || null\n    if (!rec) return NextResponse.json({ error: 'not found' }, { status: 404 })\n    return NextResponse.json({ donation: rec })\n  } catch (e: any) {\n    console.error('mpesa status error', e)\n    return NextResponse.json({ error: e?.message || 'server error' }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,IAAI,GAAY;IACpC,IAAI;QACF,MAAM,MAAM,IAAI,IAAI,IAAI,GAAG;QAC3B,MAAM,aAAa,IAAI,YAAY,CAAC,GAAG,CAAC;QACxC,IAAI,CAAC,YAAY,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAmB,GAAG;YAAE,QAAQ;QAAI;QACvF,MAAM,UAAU,SAAS,YAAY;QACrC,IAAI,OAAO,KAAK,CAAC,UAAU,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA6B,GAAG;YAAE,QAAQ;QAAI;QAE3G,MAAM,OAAY,MAAM,IAAA,wHAAS,EAAC,CAAC,oLAAoL,CAAC,EAAE;QAC1N,MAAM,MAAM,MAAM,CAAC,EAAE,IAAI;QACzB,IAAI,CAAC,KAAK,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAY,GAAG;YAAE,QAAQ;QAAI;QACzE,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,UAAU;QAAI;IAC3C,EAAE,OAAO,GAAQ;QACf,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO,GAAG,WAAW;QAAe,GAAG;YAAE,QAAQ;QAAI;IAClF;AACF","debugId":null}}]
}