{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///home/lod/Downloads/jwrc/app/api/auth/send-welcome-email/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport nodemailer from \"nodemailer\"\n\nexport async function POST(req: Request) {\n  try {\n    const body = await req.json()\n    const { email, name } = body || {}\n\n    if (!email) {\n      return NextResponse.json({ error: 'Email is required' }, { status: 400 })\n    }\n\n    // Create a test account if no SMTP credentials are configured\n    let transporter\n    \n    if (process.env.SMTP_HOST && process.env.SMTP_USER && process.env.SMTP_PASS) {\n      // Production email configuration\n      transporter = nodemailer.createTransport({\n        host: process.env.SMTP_HOST,\n        port: Number(process.env.SMTP_PORT) || 587,\n        secure: process.env.SMTP_SECURE === 'true', // true for 465, false for other ports\n        auth: {\n          user: process.env.SMTP_USER,\n          pass: process.env.SMTP_PASS,\n        },\n      })\n    } else {\n      // Development: Create a test account with Ethereal\n      const testAccount = await nodemailer.createTestAccount()\n      transporter = nodemailer.createTransport({\n        host: 'smtp.ethereal.email',\n        port: 587,\n        secure: false,\n        auth: {\n          user: testAccount.user,\n          pass: testAccount.pass,\n        },\n      })\n    }\n\n    const displayName = name || 'Member'\n    \n    // Send email\n    const info = await transporter.sendMail({\n      from: process.env.SMTP_FROM || '\"Church Community\" <noreply@church.org>',\n      to: email,\n      subject: 'Welcome to Our Church Community! üôè',\n      html: `\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <style>\n            body {\n              font-family: Arial, sans-serif;\n              line-height: 1.6;\n              color: #333;\n              max-width: 600px;\n              margin: 0 auto;\n              padding: 20px;\n            }\n            .header {\n              background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n              color: white;\n              padding: 30px;\n              border-radius: 10px 10px 0 0;\n              text-align: center;\n            }\n            .content {\n              background: #f9fafb;\n              padding: 30px;\n              border-radius: 0 0 10px 10px;\n            }\n            .button {\n              display: inline-block;\n              padding: 12px 30px;\n              background: #667eea;\n              color: white;\n              text-decoration: none;\n              border-radius: 5px;\n              margin: 20px 0;\n            }\n            .footer {\n              text-align: center;\n              margin-top: 20px;\n              color: #666;\n              font-size: 14px;\n            }\n          </style>\n        </head>\n        <body>\n          <div class=\"header\">\n            <h1>Welcome to Our Community!</h1>\n          </div>\n          <div class=\"content\">\n            <h2>Hello ${displayName}! üëã</h2>\n            <p>Thank you for registering with our church community. We're thrilled to have you join us!</p>\n            \n            <p>Your account has been successfully created. You can now:</p>\n            <ul>\n              <li>View upcoming events and register to attend</li>\n              <li>Read our latest sermons and announcements</li>\n              <li>Make donations to support our mission</li>\n              <li>Sign up to volunteer for various activities</li>\n              <li>Participate in our community programs</li>\n            </ul>\n\n            <p>We're here to support you on your spiritual journey and help you connect with our community.</p>\n            \n            <div style=\"background: #fff; border-left: 4px solid #667eea; padding: 20px; margin: 20px 0; font-style: italic;\">\n              <p style=\"margin: 0; color: #555; font-size: 15px;\">\n                \"Yet a time is coming and has now come when the true worshipers will worship the Father in the Spirit and in truth, for they are the kind of worshipers the Father seeks.\"\n              </p>\n              <p style=\"margin: 10px 0 0 0; color: #667eea; font-weight: bold; text-align: right;\">\n                - John 4:23\n              </p>\n            </div>\n            \n            <center>\n              <a href=\"${process.env.NEXT_PUBLIC_URL || 'http://localhost:3000'}/dashboard\" class=\"button\">\n                Go to Dashboard\n              </a>\n            </center>\n\n            <p>If you have any questions or need assistance, please don't hesitate to reach out to us.</p>\n            \n            <p>Blessings,<br>\n            <strong>The Church Community Team</strong></p>\n          </div>\n          <div class=\"footer\">\n            <p>This email was sent because you registered an account with us.</p>\n          </div>\n        </body>\n        </html>\n      `,\n      text: `\n        Welcome to Our Church Community!\n        \n        Hello ${displayName}!\n        \n        Thank you for registering with our church community. We're thrilled to have you join us!\n        \n        Your account has been successfully created. You can now:\n        - View upcoming events and register to attend\n        - Read our latest sermons and announcements\n        - Make donations to support our mission\n        - Sign up to volunteer for various activities\n        - Participate in our community programs\n        \n        We're here to support you on your spiritual journey and help you connect with our community.\n        \n        \"Yet a time is coming and has now come when the true worshipers will worship the Father in the Spirit and in truth, for they are the kind of worshipers the Father seeks.\" - John 4:23\n        \n        Visit your dashboard: ${process.env.NEXT_PUBLIC_URL || 'http://localhost:3000'}/dashboard\n        \n        If you have any questions or need assistance, please don't hesitate to reach out to us.\n        \n        Blessings,\n        The Church Community Team\n      `,\n    })\n\n    // If using Ethereal (development), log the preview URL\n    if (!process.env.SMTP_HOST) {\n      console.log('Preview URL: %s', nodemailer.getTestMessageUrl(info))\n    }\n\n    return NextResponse.json({ \n      success: true, \n      messageId: info.messageId,\n      previewUrl: nodemailer.getTestMessageUrl(info) || undefined\n    })\n  } catch (error) {\n    console.error('Email sending error:', error)\n    return NextResponse.json({ error: 'Failed to send email' }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,QAAQ,CAAC;QAEjC,IAAI,CAAC,OAAO;YACV,OAAO,uRAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAoB,GAAG;gBAAE,QAAQ;YAAI;QACzE;QAEA,8DAA8D;QAC9D,IAAI;QAEJ,IAAI,QAAQ,GAAG,CAAC,SAAS,IAAI,QAAQ,GAAG,CAAC,SAAS,IAAI,QAAQ,GAAG,CAAC,SAAS,EAAE;YAC3E,iCAAiC;YACjC,cAAc,4NAAU,CAAC,eAAe,CAAC;gBACvC,MAAM,QAAQ,GAAG,CAAC,SAAS;gBAC3B,MAAM,OAAO,QAAQ,GAAG,CAAC,SAAS,KAAK;gBACvC,QAAQ,QAAQ,GAAG,CAAC,WAAW,KAAK;gBACpC,MAAM;oBACJ,MAAM,QAAQ,GAAG,CAAC,SAAS;oBAC3B,MAAM,QAAQ,GAAG,CAAC,SAAS;gBAC7B;YACF;QACF,OAAO;YACL,mDAAmD;YACnD,MAAM,cAAc,MAAM,4NAAU,CAAC,iBAAiB;YACtD,cAAc,4NAAU,CAAC,eAAe,CAAC;gBACvC,MAAM;gBACN,MAAM;gBACN,QAAQ;gBACR,MAAM;oBACJ,MAAM,YAAY,IAAI;oBACtB,MAAM,YAAY,IAAI;gBACxB;YACF;QACF;QAEA,MAAM,cAAc,QAAQ;QAE5B,aAAa;QACb,MAAM,OAAO,MAAM,YAAY,QAAQ,CAAC;YACtC,MAAM,QAAQ,GAAG,CAAC,SAAS,IAAI;YAC/B,IAAI;YACJ,SAAS;YACT,MAAM,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sBA+CS,EAAE,YAAY;;;;;;;;;;;;;;;;;;;;;;;;uBAwBb,EAAE,QAAQ,GAAG,CAAC,eAAe,IAAI,wBAAwB;;;;;;;;;;;;;;;MAe1E,CAAC;YACD,MAAM,CAAC;;;cAGC,EAAE,YAAY;;;;;;;;;;;;;;;8BAeE,EAAE,QAAQ,GAAG,CAAC,eAAe,IAAI,wBAAwB;;;;;;MAMjF,CAAC;QACH;QAEA,uDAAuD;QACvD,IAAI,CAAC,QAAQ,GAAG,CAAC,SAAS,EAAE;YAC1B,QAAQ,GAAG,CAAC,mBAAmB,4NAAU,CAAC,iBAAiB,CAAC;QAC9D;QAEA,OAAO,uRAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,WAAW,KAAK,SAAS;YACzB,YAAY,4NAAU,CAAC,iBAAiB,CAAC,SAAS;QACpD;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,uRAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAuB,GAAG;YAAE,QAAQ;QAAI;IAC5E;AACF","debugId":null}}]
}